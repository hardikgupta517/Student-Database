{% extends 'base.html' %}

{% block content %}
<div class="dashboard-header">
  <h1>Student Dashboard</h1>
  <button class="btn btn-primary" onclick="document.getElementById('add-modal').style.display='flex'">
    + New Student
  </button>
</div>

<!-- Search Bar -->
<div class="search-container">
  <form action="{{ url_for('index') }}" method="GET" class="search-form">
    <input type="text" name="query" placeholder="Search by name or roll number..."
      value="{{ request.args.get('query', '') }}">
    <button type="submit" class="btn btn-secondary">Search</button>
    {% if request.args.get('query') %}
    <a href="{{ url_for('index') }}" class="btn btn-outline">Clear</a>
    {% endif %}
  </form>
</div>

<!-- Students Table -->
<div class="card">
  <div class="table-responsive">
    <table class="student-table">
      <thead>
        <tr>
          <th>Roll No</th>
          <th>Name</th>
          <th>Branch</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for student in students %}
        <tr>
          <td><span class="badge">{{ student.roll }}</span></td>
          <td class="font-medium">{{ student.name }}</td>
          <td>{{ student.branch }}</td>
          <td class="actions">
            <a href="{{ url_for('edit_student', roll=student.roll) }}" class="btn-icon edit" title="Edit">
              âœŽ
            </a>
            <a href="{{ url_for('delete_student', roll=student.roll) }}" class="btn-icon delete" title="Delete"
              onclick="return confirm('Are you sure you want to delete this student?')">
              ðŸ—‘
            </a>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="empty-state">
            No students found. Add one to get started!
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Add Student Modal -->
<div id="add-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Add New Student</h2>
      <span class="close" onclick="document.getElementById('add-modal').style.display='none'">&times;</span>
    </div>
    <form action="{{ url_for('add_student') }}" method="POST" class="modal-form">
      <div class="form-group">
        <label for="name">Full Name</label>
        <input type="text" id="name" name="name" required placeholder="e.g. John Doe">
      </div>
      <div class="form-group">
        <label for="roll">Roll Number</label>
        <input type="text" id="roll" name="roll" required placeholder="e.g. 101">
      </div>
      <div class="form-group">
        <label for="branch">Branch</label>
        <input type="text" id="branch" name="branch" required placeholder="e.g. Computer Science">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline"
          onclick="document.getElementById('add-modal').style.display='none'">Cancel</button>
        <button type="submit" class="btn btn-primary">Add Student</button>
      </div>
    </form>
  </div>
</div>

<script>
  // Close modal when clicking outside
  window.onclick = function (event) {
    var modal = document.getElementById('add-modal');
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
</script>
{% endblock %}